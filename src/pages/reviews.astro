---
import BaseLayout from '../layouts/BaseLayout.astro';
import Hero from '../components/Hero.astro';
import ReviewCard from '../components/ReviewCard.astro';
import ContactForm from '../components/ContactForm.astro';
import { site } from '../site.config';
import { getInnerHero, getHomeHero } from '../images';

const heroImage = getInnerHero() || getHomeHero()!;
---

<BaseLayout
  title={site.reviews.metaTitle}
  description={site.reviews.metaDescription}
>
  <Hero
    title="Customer Reviews"
    subtitle="See what our clients say about our service"
    backgroundImage={heroImage}
  />

  <!-- Rating Summary -->
  {site.reviews.totalReviews > 0 && (
    <section class="py-12 bg-surface">
      <div class="max-w-4xl mx-auto px-4 sm:px-6 text-center">
        <div class="bg-background rounded-md p-8 md:p-12 shadow-sm">
          <div class="flex items-center justify-center gap-2 mb-4">
            {[1, 2, 3, 4, 5].map((star) => (
              <svg
                class={`w-8 h-8 md:w-10 md:h-10 ${star <= site.reviews.averageRating ? 'text-yellow-400' : 'text-gray-300'}`}
                fill="currentColor"
                viewBox="0 0 20 20"
                aria-hidden="true"
              >
                <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
              </svg>
            ))}
          </div>
          <p class="text-5xl md:text-6xl font-[family-name:var(--font-display)] text-primary mb-2">{site.reviews.averageRating}/5</p>
          <p class="text-muted text-lg">Based on <strong class="text-primary">{site.reviews.totalReviews}+</strong> customer reviews</p>
        </div>
      </div>
    </section>
  )}

  <!-- Reviews Grid -->
  <section class="py-16 md:py-20 bg-background">
    <div class="max-w-6xl mx-auto px-4 sm:px-6">
      {site.reviews.items.length > 0 ? (
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          {site.reviews.items.map((review) => (
            <ReviewCard
              name={review.name}
              text={review.text}
              rating={review.rating}
              date={review.date || ''}
              service={review.service}
              source={review.source}
            />
          ))}
        </div>
      ) : (
        <div class="text-center py-12">
          <p class="text-muted text-lg">Reviews coming soon. Contact us to share your experience.</p>
        </div>
      )}
    </div>
  </section>

  <ContactForm />
</BaseLayout>
